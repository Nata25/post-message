<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script
      id="rwc-embed-script"
      async
      src="https://chat.staging.onereach.ai/lib/richWebChat.umd.min.js"
    ></script>
    <link rel="stylesheet" href="https://chat.staging.onereach.ai/lib/richWebChat.css"/>
    <style>
      :root {
        color-scheme: light;
      }
      .wrapper {
        display: flex;
        flex-direction: column;
        gap: 16px;
        height: 100%;
        width: 100%;
        justify-content: center;
        align-items: center;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        font-size: 32px;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <!-- <a href="https://nata25.github.io/post-message/inner">Inner</a> -->
      <a href="http://127.0.0.1:5500/inner/index.html">Inner</a>
    </div>
    <div id="rwc">
    </div>
    <script>
      /* Redirect logic */
      // const ROOT_URL = 'http://127.0.0.1:5500';
      const ROOT_URL = 'https://nata25.github.io/post-message/';
      // const INNER_URL = 'http://127.0.0.1:5500/inner/index.html';
      const INNER_URL = 'https://nata25.github.io/post-message/inner';

      window.addEventListener('message', (message) => {
        if (message.data.name === 'buttonClicked') {
          const choice = message.data.value;
          const url = INNER_URL;
          if (url) {
            localStorage.setItem('clickedButtonId', choice);
            window.open(url);
          }
        }
      });

      /* Chat logic */

      const scriptEl = document.getElementById('rwc-embed-script');
    
      scriptEl.addEventListener('load', initEmbedChat);
      initEmbedChat();
    
      function initEmbedChat() {
        var richWebChat = window.richWebChat;
        if (window.isRwcEmbedLoaded || !richWebChat) {
          return;
        }
        
        window.isRwcEmbedLoaded = true;
    
        var RWC = richWebChat.default;
        var app = new RWC({
          container: '#rwc', // DOM element selector where chat will be inserted
          // chatUrl: 'https://chat.qa.onereach.ai/VhBiKYesRSWBvfZZq6y-Vg/07uncpo',
          // chatUrl: 'https://chat.staging.onereach.ai/f84RZIZET1iHeuKgZf5gAw/00hodnv?__rwc_embed__=true`&continueSession=true',
          // chatUrl: 'https://chat.staging.onereach.ai/f84RZIZET1iHeuKgZf5gAw/0hymvst?__rwc_embed__=true`&continueSession=true',        
          chatUrl: 'https://chat.staging.onereach.ai/f84RZIZET1iHeuKgZf5gAw/0398dh0?__rwc_embed__=true`&continueSession=true',
          appearance: {
            blurredBackground: false,
            resizeable: false,
            draggable: true,
            saveChatSize: true,
            preloadInBackground: false
          },
          
          widget: {
            position: 'bottom-right',
            animation: 'pulse', // 'pulse', 'ring', 'zoom',
            color: '#D32F2F',
            logoUrl: '',
            revealDelay: 0,
            openDelay: 0,
          },
          
          invitation: {
            closeable: false,
            imageUrl: '',
            message: '',
            buttonLabel: '',
            appearDelay: 5000,
            soundLocation: '',
          },
          
          pageData: {
            fname: 'foo'
          }
        })
      };
    </script>
  </body>
</html>
  